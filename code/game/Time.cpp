#include "Time.hpp"
#include "BaalExceptions.hpp"

using namespace baal;

///////////////////////////////////////////////////////////////////////////////
Time::Time()
///////////////////////////////////////////////////////////////////////////////
  : m_curr_year(STARTING_YEAR),
    m_curr_season(FIRST_SEASON_OF_YEAR)
{}

///////////////////////////////////////////////////////////////////////////////
void Time::operator++()
///////////////////////////////////////////////////////////////////////////////
{
  if (m_curr_season == LAST_SEASON_OF_YEAR) {
    m_curr_season = FIRST_SEASON_OF_YEAR;
    ++m_curr_year;
  }
  else {
    ++m_curr_season;
  }
}

///////////////////////////////////////////////////////////////////////////////
void Time::draw_text(std::ostream& out) const
///////////////////////////////////////////////////////////////////////////////
{
  out << m_curr_season << ", " << m_curr_year << "\n";
}

///////////////////////////////////////////////////////////////////////////////
std::string Time::season_id_to_str(Season season)
///////////////////////////////////////////////////////////////////////////////
{
  switch(season) {
  case WINTER:
    return "Winter";
    break;
  case SPRING:
    return "Spring";
    break;
  case SUMMER:
    return "Summer";
    break;
  case FALL:
    return "Fall";
    break;
  default:
    Require(false, "Unknown season: " << season);
  }
}

///////////////////////////////////////////////////////////////////////////////
std::ostream& baal::operator<<(std::ostream& out, Season season)
///////////////////////////////////////////////////////////////////////////////
{
  return out << Time::season_id_to_str(season);
}

///////////////////////////////////////////////////////////////////////////////
void baal::operator++(Season& season)
///////////////////////////////////////////////////////////////////////////////
{
  Require(season != Time::LAST_SEASON_OF_YEAR, "Cannot increment: " << season);

  unsigned temp = static_cast<unsigned>(season);
  ++temp;
  season = static_cast<Season>(temp);
}
